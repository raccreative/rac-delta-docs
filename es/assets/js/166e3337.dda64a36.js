"use strict";(globalThis.webpackChunkrac_delta_docs=globalThis.webpackChunkrac_delta_docs||[]).push([[1445],{3966:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>d,toc:()=>a});const d=JSON.parse('{"id":"reference/Rust/pipelines/url-download-pipeline","title":"UrlDownloadPipeline","description":"Abstract download pipeline adapter for url-based chunk access for download flow.","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/reference/Rust/pipelines/url-download-pipeline.md","sourceDirName":"reference/Rust/pipelines","slug":"/reference/Rust/pipelines/url-download-pipeline","permalink":"/rac-delta-docs/es/reference/Rust/pipelines/url-download-pipeline","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"UrlDownloadPipeline","description":"Abstract download pipeline adapter for url-based chunk access for download flow.","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"HashDownloadPipeline","permalink":"/rac-delta-docs/es/reference/Rust/pipelines/hash-download-pipeline"}}');var s=r(4848),l=r(8453);const i={title:"UrlDownloadPipeline",description:"Abstract download pipeline adapter for url-based chunk access for download flow.",sidebar_position:4},c="UrlDownloadPipeline",o={},a=[{value:"Constructor",id:"constructor",level:2},{value:"M\xe9todos",id:"m\xe9todos",level:2},{value:"DownloadOptions",id:"downloadoptions",level:2},{value:"DownloadError",id:"downloaderror",level:2},{value:"UpdateStrategy",id:"updatestrategy",level:2},{value:"Detalles de m\xe9todos",id:"detalles-de-m\xe9todos",level:2},{value:"<code>execute(local_dir, urls, strategy,  plan, options)</code>",id:"executelocal_dir-urls-strategy--plan-options",level:3},{value:"<code>save_local_index(local_dir, index)</code>",id:"save_local_indexlocal_dir-index",level:3},{value:"<code>load_local_index(dir)</code>",id:"load_local_indexdir",level:3},{value:"<code>find_local_index(local_dir)</code>",id:"find_local_indexlocal_dir",level:3},{value:"<code>download_all_missing_chunks(download_urls, target, options)</code>",id:"download_all_missing_chunksdownload_urls-target-options",level:3},{value:"<code>verify_and_delete_obsolete_chunks(plan, local_dir, remote_index, chunk_source, options)</code>",id:"verify_and_delete_obsolete_chunksplan-local_dir-remote_index-chunk_source-options",level:3},{value:"<code>update_progress(value, phase, disk_usage, speed, options)</code>",id:"update_progressvalue-phase-disk_usage-speed-options",level:3},{value:"<code>change_state(state, options)</code>",id:"change_statestate-options",level:3},{value:"Relacionado",id:"relacionado",level:2}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"urldownloadpipeline",children:"UrlDownloadPipeline"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"UrlDownloadPipeline"})," es una clase abstracta dise\xf1ada para manejar subidas usando adaptadores de almacenamiento basados en URLs (",(0,s.jsx)(n.code,{children:"UrlStorageAdapter"}),").\nA diferencia de ",(0,s.jsx)(n.code,{children:"HashDownloadPipeline"}),", esta pipeline da por hecho que el plan delta (qu\xe9 chunks descargar) es calculado externamente y proporcionado a la pipeline."]}),"\n",(0,s.jsx)(n.p,{children:"Esta pipeline es com\xfanmente usada para los sistemas de almacenamiento remotos donde los chunks tienen una URL dedicada para la descarga."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"constructor",children:"Constructor"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Par\xe1metro"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"storage"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Arc<dyn UrlStorageAdapter>"})}),(0,s.jsx)(n.td,{children:"Adaptador de almacenamiento basado en urls que se usar\xe1 (se crea autom\xe1ticamente con el cliente)."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"reconstruction"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Arc<dyn ReconstructionService>"})}),(0,s.jsx)(n.td,{children:"ReconstructionService usado para reconstrucci\xf3n de archivos locales."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"validation"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Arc<dyn ValidationService>"})}),(0,s.jsx)(n.td,{children:"ValidationService usado para validar archivos tras reconstruirlos."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"delta"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Arc<dyn DeltaService>"})}),(0,s.jsx)(n.td,{children:"DeltaService usado para generar \xedndices y compararlos."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"config"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Arc<RacDeltaConfig>"})}),(0,s.jsx)(n.td,{children:"Configuraci\xf3n base del cliente."})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"m\xe9todos",children:"M\xe9todos"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"M\xe9todo"}),(0,s.jsx)(n.th,{children:"Devuelve"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"execute(local_dir, urls, strategy,  plan, options)"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Result<(), DownloadError>"})}),(0,s.jsx)(n.td,{children:"Realiza un proceso completo de descarga para el directorio usando urls."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"save_local_index(local_dir, index)"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Result<(), DownloadError>"})}),(0,s.jsx)(n.td,{children:"Este m\xe9todo guardar\xe1 el nuevo \xedndice local en la carpeta dada."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"load_local_index(dir)"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Result<RDIndex, DownloadError>"})}),(0,s.jsx)(n.td,{children:"Crear\xe1 un rd-index.json del directorio dado."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"find_local_index(local_dir)"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Result<Option<RDIndex>, DownloadError>"})}),(0,s.jsx)(n.td,{children:"Buscar\xe1 un rd-index.json en la carpeta dada si existe."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"download_all_missing_chunks(download_urls, target, options)"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Result<Arc<dyn ChunkSource>, DownloadError>"})}),(0,s.jsx)(n.td,{children:"Este m\xe9todo descargar\xe1 primero todos los chunks necesarios v\xeda urls, y los guardar\xe1 temporalmente en disco o memoria."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"verify_and_delete_obsolete_chunks(plan, local_dir, remote_index, chunk_source, options)"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Result<FileVerificationResult, DownloadError>"})}),(0,s.jsx)(n.td,{children:"Este m\xe9todo comprobar\xe1 los archivos reconstruidos, verificando sus hashes y los chunks obsoletos."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"update_progress(value, phase, disk_usage, speed, options)"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"()"})}),(0,s.jsx)(n.td,{children:"Este m\xe9todo llamar\xe1 a la callback de progreso dada en opciones."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"change_state(state, options)"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"()"})}),(0,s.jsx)(n.td,{children:"Este m\xe9todo llamar\xe1 a la callback de estado dada en opciones."})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"downloadoptions",children:"DownloadOptions"}),"\n",(0,s.jsxs)(n.p,{children:["El objeto ",(0,s.jsx)(n.code,{children:"DownloadOptions"})," permite personalizar el comportamiento de una descarga:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub struct DownloadOptions {\n    pub force: Option<bool>,\n    pub chunks_save_path: Option<PathBuf>,\n    pub use_existing_index: Option<bool>,\n    pub file_reconstruction_concurrency: Option<usize>,\n    pub in_place_reconstruction_threshold: Option<u64>,\n    pub on_progress:\n        Option<Arc<dyn Fn(DownloadPhase, f64, Option<f64>, Option<f64>) + Send + Sync>>,\n    pub on_state_change: Option<Arc<dyn Fn(DownloadState) + Send + Sync>>,\n}\n"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Propiedad"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"force"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<bool>"})}),(0,s.jsx)(n.td,{children:"Si es true, descarga todo. Si es false, solo los chunks nuevos y modificados se descargar\xe1n."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"chunks_save_path"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<PathBuf>"})}),(0,s.jsxs)(n.td,{children:["Ruta donde se guardar\xe1n los chunks si la estrategia ",(0,s.jsx)(n.code,{children:"DownloadAllFirstToDisk"})," es la seleccionada."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"use_existing_index"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<bool>"})}),(0,s.jsx)(n.td,{children:"Si es true, buscar\xe1 primero un rd-index existente en el directorio local."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"file_reconstruction_concurrency"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<usize>"})}),(0,s.jsx)(n.td,{children:"Cu\xe1ntos archivos se reconstruir\xe1n concurrentemente."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"in_place_reconstruction_threshold"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<u64>"})}),(0,s.jsxs)(n.td,{children:["Tama\xf1o m\xednimo de archivo (en bytes) necesarios para realizar una ",(0,s.jsx)(n.strong,{children:"reconstrucci\xf3n in-place"})," en lugar de usar un archivo temporal."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"on_progress"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<Arc<dyn Fn(DownloadPhase, f64, Option<f64>, Option<f64>) + Send + Sync>>"})}),(0,s.jsx)(n.td,{children:"Callback opcional para informar progreso."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"on_state_change"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<Arc<dyn Fn(DownloadState) + Send + Sync>>"})}),(0,s.jsx)(n.td,{children:"Callback opcional para cambios de estado."})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub enum DownloadState {\n    Downloading,\n    Reconstructing,\n    Cleaning,\n    Scanning,\n}\n\npub enum DownloadPhase {\n    Download,\n    Reconstructing,\n    Deleting,\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"downloaderror",children:"DownloadError"}),"\n",(0,s.jsxs)(n.p,{children:["Enum de errores personalizado para los resultados de DownloadPipeline. (Usa ",(0,s.jsx)(n.code,{children:"thiserror"}),")"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:'pub enum DownloadError {\n    #[error("I/O error: {0}")]\n    Io(#[from] std::io::Error),\n\n    #[error("Delta error: {0}")]\n    Delta(String),\n\n    #[error("Storage error: {0}")]\n    Storage(String),\n\n    #[error("Index error: {0}")]\n    Index(String),\n\n    #[error("Validation error: {0}")]\n    Validation(String),\n\n    #[error("Reconstruction error: {0}")]\n    Reconstruction(String),\n\n    #[error("Invalid argument: {0}")]\n    InvalidArgument(String),\n\n    #[error("Operation aborted")]\n    Aborted,\n\n    #[error("Other error: {0}")]\n    Other(String),\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"updatestrategy",children:"UpdateStrategy"}),"\n",(0,s.jsx)(n.p,{children:"Enum con diferentes estrategias para reconstruir y descargar archivos."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub enum UpdateStrategy {\n    DownloadAllFirstToMemory,\n    StreamFromNetwork,\n    DownloadAllFirstToDisk,\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Para m\xe1s info, mira: ",(0,s.jsx)(n.a,{href:"/usage/downloading#update-strategies",children:"Uso de la pipeline de descarga"})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"detalles-de-m\xe9todos",children:"Detalles de m\xe9todos"}),"\n",(0,s.jsx)(n.h3,{id:"executelocal_dir-urls-strategy--plan-options",children:(0,s.jsx)(n.code,{children:"execute(local_dir, urls, strategy,  plan, options)"})}),"\n",(0,s.jsx)(n.p,{children:"Realiza un proceso completo de descarga para el directorio v\xeda urls."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Par\xe1metros"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Nombre"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"local_dir"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"&Path"})}),(0,s.jsx)(n.td,{children:"Directorio donde se descargar\xe1 todo."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"urls.download_urls"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"HashMap<String, ChunkUrlInfo>"})}),(0,s.jsx)(n.td,{children:"Las urls identificadas por hash para descargar los chunks. Mira ChunkUrlInfo abajo."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"urls.index_url"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"String"})}),(0,s.jsx)(n.td,{children:"Url para descargar el rd-index.json remoto."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"strategy"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"UpdateStrategy"})}),(0,s.jsxs)(n.td,{children:["Estrategia a usar para descargar y reconstruir. Mira ",(0,s.jsx)(n.a,{href:"/usage/downloading#update-strategies",children:"UpdateStrategy"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"plan"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<DeltaPlan>"})}),(0,s.jsx)(n.td,{children:"DeltaPlan opcional para referencia, si no se proporciona ninguno, se intentar\xe1 generar."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"options"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<DownloadOptions>"})}),(0,s.jsx)(n.td,{children:"Opciones para el proceso de descarga. Mira DownloadOptions arriba."})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub struct ChunkUrlInfo {\n    pub url: String,\n    pub offset: u64,\n    pub size: u64,\n    pub file_path: String,\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Echa un ojo a ",(0,s.jsx)(n.a,{href:"/reference/Rust/models/chunk-url-info",children:"ChunkUrlInfo"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Devuelve"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"Result<(), DownloadError>"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"save_local_indexlocal_dir-index",children:(0,s.jsx)(n.code,{children:"save_local_index(local_dir, index)"})}),"\n",(0,s.jsx)(n.p,{children:"Este m\xe9todo guardar\xe1 el nuevo \xedndice local en la carpeta dada."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Par\xe1metros"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Nombre"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"local_dir"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"&Path"})}),(0,s.jsx)(n.td,{children:"Directorio donde el nuevo \xedndice ser\xe1 guardado."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"index"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"&RDIndex"})}),(0,s.jsx)(n.td,{children:"El objeto RDIndex a guardar."})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Devuelve"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"Result<(), DownloadError>"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"load_local_indexdir",children:(0,s.jsx)(n.code,{children:"load_local_index(dir)"})}),"\n",(0,s.jsx)(n.p,{children:"Este m\xe9todo crear\xe1 un rd-index.json de un directorio dado, escaneando archivos y generando hashes."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Par\xe1metros"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Nombre"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"dir"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"&Path"})}),(0,s.jsx)(n.td,{children:"Ruta del directorio para generar el \xedndice."})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Devuelve"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"Result<RDIndex, DownloadError>"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"find_local_indexlocal_dir",children:(0,s.jsx)(n.code,{children:"find_local_index(local_dir)"})}),"\n",(0,s.jsx)(n.p,{children:"Este m\xe9todo buscar\xe1 un rd-index.json si existe en el directorio dado."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Par\xe1metros"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Nombre"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"local_dir"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"&Path"})}),(0,s.jsx)(n.td,{children:"Ruta del directorio para buscar el \xedndice."})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Devuelve"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"Result<Option<RDIndex>, DownloadError>"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"download_all_missing_chunksdownload_urls-target-options",children:(0,s.jsx)(n.code,{children:"download_all_missing_chunks(download_urls, target, options)"})}),"\n",(0,s.jsx)(n.p,{children:"Este m\xe9todo descargar\xe1 primero todos los chunks necesarios, y los guardar\xe1 temporalmente en disco o memoria."}),"\n",(0,s.jsxs)(n.p,{children:["Devolver\xe1 un ",(0,s.jsx)(n.code,{children:"ChunkSource"}),", los ChunkSource ser\xe1n necesarios para reconstruir archivos, este m\xe9todo SOLO devolver\xe1 chunks sources de memoria o disco para reconstrucci\xf3n offline, si quieres usar almacenamiento como S3, puedes omitir esto y usar directamente un ",(0,s.jsx)(n.code,{children:"StorageChunkSource"})," con ",(0,s.jsx)(n.code,{children:"reconstruction.reconstructAll()"})," si lo prefieres."]}),"\n",(0,s.jsx)(n.p,{children:"(Usar StorageChunkSource descargar\xe1 los chunks y reconstruir\xe1 los archivos al mismo tiempo, concurrentemente)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Par\xe1metros"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Nombre"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"downloadUrls"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"HashMap<String, ChunkUrlInfo>"})}),(0,s.jsx)(n.td,{children:"Las urls identificadas por hash para descargar los chunks. Mira ChunkUrlInfo arriba."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"target"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DownloadTarget"})}),(0,s.jsx)(n.td,{children:"Objetivo del ChunkSource resultante."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"options"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<DownloadOptions>"})}),(0,s.jsx)(n.td,{children:"Opciones para el proceso de descarga. Mira DownloadOptions arriba."})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub enum DownloadTarget {\n    Memory,\n    Disk,\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Devuelve"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"Result<Arc<dyn ChunkSource>, DownloadError>"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"verify_and_delete_obsolete_chunksplan-local_dir-remote_index-chunk_source-options",children:(0,s.jsx)(n.code,{children:"verify_and_delete_obsolete_chunks(plan, local_dir, remote_index, chunk_source, options)"})}),"\n",(0,s.jsx)(n.p,{children:"Este m\xe9todo comprobar\xe1 los archivos reconstruidos, verificando sus hashes y los chunks obsoletos. Si a\xfan quedan chunks obsoletos, se eliminar\xe1n y se reconstruir\xe1 el archivo de nuevo si es necesario."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Par\xe1metros"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Nombre"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"plan"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"&DeltaPlan"})}),(0,s.jsxs)(n.td,{children:["El ",(0,s.jsx)(n.code,{children:"DeltaPlan"})," generado por delta.compare de los dos rd-index.json para la descarga."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"local_dir"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"&Path"})}),(0,s.jsx)(n.td,{children:"Ruta del directorio para comprobar archivos."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"remote_index"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"&RDIndex"})}),(0,s.jsx)(n.td,{children:"El \xedndice remoto para referencia."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"chunk_source"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Arc<dyn ChunkSource>"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"ChunkSource"})," para descargar chunks en caso de archivos inv\xe1lidos. Mira ",(0,s.jsx)(n.a,{href:"/reference/Rust/chunk-sources/chunk-source",children:"ChunkSource"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"options"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<DownloadOptions>"})}),(0,s.jsx)(n.td,{children:"Objeto de opciones, echa un ojo a DownloadOptions arriba para m\xe1s info (este m\xe9todo solo usa la callback)"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Devuelve"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"Result<FileVerificationResult, DownloadError>"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub struct FileVerificationResult {\n    pub deleted_files: Vec<String>,\n    pub verified_files: Vec<String>,\n    pub rebuilt_files: Vec<String>,\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"update_progressvalue-phase-disk_usage-speed-options",children:(0,s.jsx)(n.code,{children:"update_progress(value, phase, disk_usage, speed, options)"})}),"\n",(0,s.jsxs)(n.p,{children:["M\xe9todo que ser\xe1 usado internamente para llamar a la callback ",(0,s.jsx)(n.code,{children:"on_progress"})," dada en opciones."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Par\xe1metros"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Nombre"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"value"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"f64"})}),(0,s.jsx)(n.td,{children:"Valor del progreso."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"phase"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DownloadPhase"})}),(0,s.jsx)(n.td,{children:"Fase de descarga actual (downloading, reconstructing o deleting)."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"disk_usage"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<f64>"})}),(0,s.jsx)(n.td,{children:"Velocidad en bytes/s para la reconstrucci\xf3n."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"speed"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<f64>"})}),(0,s.jsx)(n.td,{children:"Velocidad en bytes/s para la descarga."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"options"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<&DownloadOptions>"})}),(0,s.jsxs)(n.td,{children:["Opciones que debe incluir la callback ",(0,s.jsx)(n.code,{children:"on_progress"}),"."]})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Devuelve"})," ",(0,s.jsx)(n.code,{children:"()"})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"change_statestate-options",children:(0,s.jsx)(n.code,{children:"change_state(state, options)"})}),"\n",(0,s.jsxs)(n.p,{children:["M\xe9todo que ser\xe1 usado internamente para llamar a la callback ",(0,s.jsx)(n.code,{children:"on_state_change"})," dada en opciones."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Par\xe1metros"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Nombre"}),(0,s.jsx)(n.th,{children:"Tipo"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"state"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"DownloadState"})}),(0,s.jsx)(n.td,{children:"Estado actual del proceso."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"options"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Option<&DownloadOptions>"})}),(0,s.jsxs)(n.td,{children:["Opciones que debe incluir la callback ",(0,s.jsx)(n.code,{children:"on_state_change"}),"."]})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Devuelve"})," ",(0,s.jsx)(n.code,{children:"()"})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"relacionado",children:"Relacionado"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/reference/Rust/pipelines/hash-download-pipeline",children:"HashDownloadPipeline"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/reference/Rust/chunk-sources/chunk-source",children:"ChunkSource"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/reference/Rust/models/rdindex",children:"RDIndex"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/reference/Rust/models/delta-plan",children:"DeltaPlan"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>c});var d=r(6540);const s={},l=d.createContext(s);function i(e){const n=d.useContext(l);return d.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),d.createElement(l.Provider,{value:n},e.children)}}}]);