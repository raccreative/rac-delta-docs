"use strict";(globalThis.webpackChunkrac_delta_docs=globalThis.webpackChunkrac_delta_docs||[]).push([[3263],{3335:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>i,contentTitle:()=>c,default:()=>o,frontMatter:()=>h,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"reference/Rust/adapters/hash-storage-adapter","title":"HashStorageAdapter","description":"Abstract storage adapter for hash-based chunk access.","source":"@site/docs/reference/Rust/adapters/hash-storage-adapter.md","sourceDirName":"reference/Rust/adapters","slug":"/reference/Rust/adapters/hash-storage-adapter","permalink":"/rac-delta-docs/reference/Rust/adapters/hash-storage-adapter","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"HashStorageAdapter","description":"Abstract storage adapter for hash-based chunk access.","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"StorageAdapter","permalink":"/rac-delta-docs/reference/Rust/adapters/storage-adapter"},"next":{"title":"UrlStorageAdapter","permalink":"/rac-delta-docs/reference/Rust/adapters/url-storage-adapter"}}');var d=s(4848),t=s(8453);const h={title:"HashStorageAdapter",description:"Abstract storage adapter for hash-based chunk access.",sidebar_position:2},c="HashStorageAdapter",i={},l=[{value:"Methods",id:"methods",level:2},{value:"Method details",id:"method-details",level:2},{value:"<code>get_chunk(hash)</code>",id:"get_chunkhash",level:3},{value:"<code>put_chunk(hash, data, opts)</code>",id:"put_chunkhash-data-opts",level:3},{value:"<code>chunk_exists(hash)</code>",id:"chunk_existshash",level:3},{value:"<code>delete_chunk(hash)</code>",id:"delete_chunkhash",level:3},{value:"<code>list_chunks()</code>",id:"list_chunks",level:3},{value:"<code>get_chunk_info(hash)</code>",id:"get_chunk_infohash",level:3},{value:"<code>get_remote_index()</code>",id:"get_remote_index",level:3},{value:"<code>put_remote_index(index)</code>",id:"put_remote_indexindex",level:3},{value:"Related",id:"related",level:2}];function a(e){const r={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r.header,{children:(0,d.jsx)(r.h1,{id:"hashstorageadapter",children:"HashStorageAdapter"})}),"\n",(0,d.jsxs)(r.p,{children:[(0,d.jsx)(r.code,{children:"HashStorageAdapter"})," defines the contract for any storage backend that stores chunks\nidentified by ",(0,d.jsx)(r.strong,{children:"hash"}),".",(0,d.jsx)(r.br,{}),"\n","It extends ",(0,d.jsx)(r.a,{href:"./storage-adapter",children:(0,d.jsx)(r.code,{children:"StorageAdapter"})}),"."]}),"\n",(0,d.jsx)(r.p,{children:"This class is abstract; real implementations belong to the infrastructure layer\nand are not used directly by consumers of the SDK."}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h2,{id:"methods",children:"Methods"}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Method"}),(0,d.jsx)(r.th,{children:"Returns"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsxs)(r.tbody,{children:[(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"get_chunk(hash)"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Result<Option<Box<dyn AsyncRead + Send + Unpin + 'static>>, StorageError>"})}),(0,d.jsx)(r.td,{children:"Retrieve a chunk stream by its hash."})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"put_chunk(hash, data, opts)"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Result<(), StorageError>"})}),(0,d.jsx)(r.td,{children:"Upload a chunk from a readable stream."})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"chunk_exists(hash)"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Result<bool, StorageError>"})}),(0,d.jsx)(r.td,{children:"Check whether a chunk exists."})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"delete_chunk(hash)"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Result<(), StorageError>"})}),(0,d.jsx)(r.td,{children:"Delete a chunk."})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"list_chunks()"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Result<Option<Vec<String>>, StorageError>"})}),(0,d.jsx)(r.td,{children:"Optional: list stored chunk hashes."})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"get_chunk_info(hash)"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Result<Option<BlobInfo>, StorageError>"})}),(0,d.jsx)(r.td,{children:"Optional: return chunk metadata."})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"get_remote_index()"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Result<Option<RDIndex>, StorageError>"})}),(0,d.jsx)(r.td,{children:"Retrieve remote rd-index.json"})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"put_remote_index(index)"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Result<(), StorageError>"})}),(0,d.jsx)(r.td,{children:"Upload remote rd-index.json"})]})]})]}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h2,{id:"method-details",children:"Method details"}),"\n",(0,d.jsx)(r.h3,{id:"get_chunkhash",children:(0,d.jsx)(r.code,{children:"get_chunk(hash)"})}),"\n",(0,d.jsxs)(r.p,{children:["Retrieve a readable stream of a chunk, or ",(0,d.jsx)(r.code,{children:"None"})," if the chunk is not present."]}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Parameters"})}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Name"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsx)(r.tbody,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"hash"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"&str"})}),(0,d.jsx)(r.td,{children:"Chunk identifier."})]})})]}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Returns"})}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-rust",children:"Result<Option<Box<dyn AsyncRead + Send + Unpin + 'static>>, StorageError>\n"})}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h3,{id:"put_chunkhash-data-opts",children:(0,d.jsx)(r.code,{children:"put_chunk(hash, data, opts)"})}),"\n",(0,d.jsx)(r.p,{children:"Upload a chunk identified by its hash."}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Parameters"})}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Name"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsxs)(r.tbody,{children:[(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"hash"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"&str"})}),(0,d.jsx)(r.td,{children:"Chunk hash."})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"data"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Box<dyn AsyncRead + Send + Unpin + 'static>"})}),(0,d.jsx)(r.td,{children:"Source data stream."})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"opts.overwrite"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Option<bool>"})}),(0,d.jsx)(r.td,{children:"Whether to overwrite if exists."})]}),(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"opts.size"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"Option<u64>"})}),(0,d.jsx)(r.td,{children:"Optional size of the chunk, often needed by some storage providers like S3."})]})]})]}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Returns"})}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.code,{children:"Result<(), StorageError>"})}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h3,{id:"chunk_existshash",children:(0,d.jsx)(r.code,{children:"chunk_exists(hash)"})}),"\n",(0,d.jsx)(r.p,{children:"Check if a chunk with given hash exists."}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Parameters"})}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Name"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsx)(r.tbody,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"hash"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"&str"})}),(0,d.jsx)(r.td,{children:"Chunk hash."})]})})]}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Returns"})}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.code,{children:"Result<bool, StorageError>"})}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h3,{id:"delete_chunkhash",children:(0,d.jsx)(r.code,{children:"delete_chunk(hash)"})}),"\n",(0,d.jsx)(r.p,{children:"Deletes a chunk with given hash if exists."}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Parameters"})}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Name"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsx)(r.tbody,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"hash"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"&str"})}),(0,d.jsx)(r.td,{children:"Chunk identifier."})]})})]}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Returns"})}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.code,{children:"Result<(), StorageError>"})}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h3,{id:"list_chunks",children:(0,d.jsx)(r.code,{children:"list_chunks()"})}),"\n",(0,d.jsx)(r.p,{children:"Retrieves a list of chunk hashes of the workspace. Optional method."}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Returns"})}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.code,{children:"Result<option<Vec<String>>, StorageError>"})}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h3,{id:"get_chunk_infohash",children:(0,d.jsx)(r.code,{children:"get_chunk_info(hash)"})}),"\n",(0,d.jsx)(r.p,{children:"Retrieves metadata of given chunk by hash if exists. Optional method."}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Parameters"})}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Name"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsx)(r.tbody,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"hash"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"&str"})}),(0,d.jsx)(r.td,{children:"Chunk hash identifier."})]})})]}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Returns"})}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.code,{children:"Result<Option<BlobInfo>, StorageError>"})}),"\n",(0,d.jsx)(r.pre,{children:(0,d.jsx)(r.code,{className:"language-rust",children:"pub struct BlobInfo {\n  pub hash: String;\n  pub size: u64;\n  pub modified: Option<u64>;\n  pub metadata: Option<HashMap<String, String>>;\n}\n"})}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h3,{id:"get_remote_index",children:(0,d.jsx)(r.code,{children:"get_remote_index()"})}),"\n",(0,d.jsx)(r.p,{children:"Retrieves remote rd-index.json if found on workspace path."}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Returns"})}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.code,{children:"Result<Option<RDIndex>, StorageError>"})}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h3,{id:"put_remote_indexindex",children:(0,d.jsx)(r.code,{children:"put_remote_index(index)"})}),"\n",(0,d.jsx)(r.p,{children:"Uploads a rd-index.json to storage workspace (storage-config-path/rd-index.json)."}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Parameters"})}),"\n",(0,d.jsxs)(r.table,{children:[(0,d.jsx)(r.thead,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.th,{children:"Name"}),(0,d.jsx)(r.th,{children:"Type"}),(0,d.jsx)(r.th,{children:"Description"})]})}),(0,d.jsx)(r.tbody,{children:(0,d.jsxs)(r.tr,{children:[(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"index"})}),(0,d.jsx)(r.td,{children:(0,d.jsx)(r.code,{children:"RDIndex"})}),(0,d.jsx)(r.td,{children:"The rd-index object."})]})})]}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.strong,{children:"Returns"})}),"\n",(0,d.jsx)(r.p,{children:(0,d.jsx)(r.code,{children:"Result<(), StorageError>"})}),"\n",(0,d.jsx)(r.hr,{}),"\n",(0,d.jsx)(r.h2,{id:"related",children:"Related"}),"\n",(0,d.jsxs)(r.ul,{children:["\n",(0,d.jsx)(r.li,{children:(0,d.jsx)(r.a,{href:"/reference/Rust/models/rdindex",children:"RDIndex"})}),"\n",(0,d.jsx)(r.li,{children:(0,d.jsx)(r.a,{href:"/reference/Rust/adapters/storage-adapter",children:"StorageAdapter"})}),"\n",(0,d.jsx)(r.li,{children:(0,d.jsx)(r.a,{href:"/reference/Rust/adapters/storage-adapter#storageerror",children:"StorageError"})}),"\n"]})]})}function o(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,d.jsx)(r,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},8453:(e,r,s)=>{s.d(r,{R:()=>h,x:()=>c});var n=s(6540);const d={},t=n.createContext(d);function h(e){const r=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:h(e.components),n.createElement(t.Provider,{value:r},e.children)}}}]);